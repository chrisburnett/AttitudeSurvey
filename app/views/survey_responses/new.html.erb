<%= include_gon %>
<div id="help-area">
    <h2>Sensitivity of your Health Information</h2>
    <p>Please drag the green cards to arrange according to sensitivity. For example, if you feel that <emph>Medication</emph> information is highly sensitive, you would drag the <emph>Medication</emph> card onto the <emph>highly sensitive</emph> area.</p>
</div>

<div id="help-area-2">
    <h2>Sharing your Health Information</h2>
    <p>Please click on the pieces of health information you would be happy to share with someone in the role shown at the bottom of the screen.</p>
</div>

<hr/>
<%= form_for @survey_response, remote: true do |s| %>

    <%
    cat_count = @survey.sensitivity_categories.count
    # integer division gives us the number of rows
    row_count = (cat_count/3)
    if cat_count%3 > 0
        then row_count = row_count + 1
    end
    col_count = 2 # hardcoding this - want 3 columns
    categories = @survey.sensitivity_categories.to_a.dup
    %>

    <div class="container-fixed card-drop-area-container">
        <% row_count.times do %>
            <div class="row">
                <% col_count.times do |i| %>
                    <% unless categories.empty? %>
                        <% category = categories.shift %>
                        <div class="col-xs-6 card-drop-area" id="category-<%= category[:id] %>">
                            <h1 class="card-drop-area-description"><%= category[:title] %></h1>
                            <p class="card-drop-area-description"><%= category[:description] %></p>
                        </div>
                    <% end %>
                <% end %>
            </div>
        <% end %>
    </div>

    <hr/>

    <div class="container">
        <div class="row">
            <div id="categories-control-area" class="col-md-8" id="card-info">
                <p>Some text about the card goes here which gives some information like in the paper.</p>
            </div>
            <div class="col-md-4 pull-right">
                <div id="card-deck" class="btn-group"></div>
                <% @survey.cards.each do |card| %>
                    <div class="card movable" id="card-<%= card.id %>">
                        <%= card.title %>&nbsp;&nbsp;
                        <span class="glyphicon glyphicon-ok"></span>
                        <span class="glyphicon glyphicon-ban-circle"></span>
                    </div>
                <% end %>
            </div>
        </div>
    </div>

    <div id="recipients-control-area" class="container">
        <div class="row">
            <div class="col-md-3">
                <p>Please click on the items that you would be happy with sharing with a:</p>
            </div>
            <div class="col-md-9">
                <div id="recipient-name-header"></div>
            </div>
        </div>
    </div>


    <%= s.fields_for :card_placements do |cp| %>
        <%= render "card_placement_fields", f: cp %>
    <% end %>

    <p><button type="button" class="btn btn-primary" id="next-button">Next</button></p>
    <!-- Show this using JS to indicate moving to the next whole-page step -->
    <p><%= s.submit "Next", class: "btn btn-primary", id: "submit-button" %></p>
<% end %>
